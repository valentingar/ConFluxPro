<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calibration • ConFluxPro</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calibration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ConFluxPro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ConFluxPro.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_preparation.html">Data preparation</a></li>
    <li><a class="dropdown-item" href="../articles/flux.html">Flux calculation</a></li>
    <li><a class="dropdown-item" href="../articles/calibration.html">Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty.html">Uncertainty estimation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/valentingar/confluxpro/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calibration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/valentingar/confluxpro/blob/main/vignettes/calibration.Rmd" class="external-link"><code>vignettes/calibration.Rmd</code></a></small>
      <div class="d-none name"><code>calibration.Rmd</code></div>
    </div>

    
    
<p>This vignette introduces a post-hoc calibration approach mainly aimed
at <code><a href="../reference/pro_flux.html">pro_flux()</a></code> models. We will introduce the two steps
required, (I) a parameter variation with <code><a href="../reference/alternate.html">alternate()</a></code> and
(II) the evaluation of the results with
<code><a href="../reference/evaluate_models.html">evaluate_models()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://confluxpro.valentingartiser.de/" class="external-link">ConFluxPro</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'ConFluxPro'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span></code></pre></div>
<div class="section level2">
<h2 id="background-and-idea">Background and idea<a class="anchor" aria-label="anchor" href="#background-and-idea"></a>
</h2>
<p>Different input parameters of the flux-gradient method (FGM) affect
the modeled effluxes to a different extent. Most importantly, the soil
physics that we defined in <code>soilphys</code> can have significant
measurement and sampling uncertainties. The derived <code>DS</code>
values often require many input parameters and therefore have a high
uncertainty. At the same time,<code>DS</code> has a large effect on the
modeled efflux, leading to potential offsets and biases.</p>
<p>The following approach aims to quantify these effects and calibrate
ConFluxPro models. It is mostly intended to be used with inverse models
from the <code><a href="../reference/pro_flux.html">pro_flux()</a></code> method. The basic idea is to modify the
values of the input parameters within a given range and re-run the
models to quantify the effect on the efflux. In a second step, different
parameters of model quality can be calculated to select the model runs
with the lowest model error.</p>
<p>Programatically, you will mainly interact with three functions:
<code><a href="../reference/cfp_run_map.html">cfp_run_map()</a></code> to generate a plan on how to modify each
model for each run, <code>alterante()</code> to actually run all models
and <code><a href="../reference/evaluate_models.html">evaluate_models()</a></code> to calculate a model error for each
run and select the best results.</p>
<p>Let’s load in the basic model we generated in the last article.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"base_dat"</span>, package <span class="op">=</span> <span class="st">"ConFluxPro"</span><span class="op">)</span></span>
<span><span class="va">mod_pf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pro_flux.html">pro_flux</a></span><span class="op">(</span><span class="va">base_dat</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cfp_run_map-plan-model-modifications">cfp_run_map(): Plan model modifications<a class="anchor" aria-label="anchor" href="#cfp_run_map-plan-model-modifications"></a>
</h2>
<p>From a given model, we can generate a <code>run_map</code>, a plan on
how to modify each model for each run with the function
<code><a href="../reference/cfp_run_map.html">cfp_run_map()</a></code>. We will now only consider the
<code>method = "random"</code> variant, where the parameter values in
each run are randomly sampled. This requires some input parameters.
First, we need to select the parameters we want to modify. These
parameters must come from the <code>soilphys</code> dataset. Keep the
number of parameters low, because too many degrees of freedom may
prevent the approach to converge on a specific parameter set.
Furthermore, different uncertainties can be balanced out by modifying a
single parameter. For example, a too high SWC can be compensated with a
lower TPS or vice versa.</p>
<p>Here will select to only adapt the <code>TPS</code> within each
layer. We also need to tell the function, in what range we want to
modify the parameter and how to modify it. Here, we have different
options. We can either give a specified range in absolute values, for
<code>type = "abs"</code>, subtract or add a certain amount from the
original value with <code>type = "addition"</code> or multiply it with a
given factor in <code>type = "factor"</code>. For now, let’s select
<code>type = "factor"</code>, and let the TPS modify for 90-110 % its
original value. We provide this information as a named list to the
<code>param</code> argument. The names of that list represent the
columns in <code>soilphys</code> and the limits are given as a vector of
length 2. The type of modification is given as <code>type</code>, a
vector of the same length as <code>params</code>. The last thing we now
have to provide is the number of model runs to generate by providing an
integer number to <code>n_runs</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tps_run_map</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/cfp_run_map.html">cfp_run_map</a></span><span class="op">(</span><span class="va">mod_pf</span>,</span>
<span>              params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"TPS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"factor"</span>,</span>
<span>              method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>              n_runs <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>With this we have a valid object of class <code>cfp_run_map</code>.
This object is a <code>data.frame</code> where each new run is
identified by the column <code>run_id</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tps_run_map</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A cfp_run_map to be used in alternate(). </span></span>
<span><span class="co">#&gt; number of runs:  100 </span></span>
<span><span class="co">#&gt; parameters to alternate:</span></span>
<span><span class="co">#&gt;   param param_id</span></span>
<span><span class="co">#&gt; 1   TPS        1</span></span>
<span><span class="co">#&gt;   run_id param     value   type gas param_id</span></span>
<span><span class="co">#&gt; 1      1   TPS 0.9161500 factor CO2        1</span></span>
<span><span class="co">#&gt; 2      2   TPS 1.0668666 factor CO2        1</span></span>
<span><span class="co">#&gt; 3      3   TPS 1.0201522 factor CO2        1</span></span>
<span><span class="co">#&gt; 4      4   TPS 0.9314417 factor CO2        1</span></span>
<span><span class="co">#&gt; 5      5   TPS 0.9014799 factor CO2        1</span></span>
<span><span class="co">#&gt; 6      6   TPS 0.9932787 factor CO2        1</span></span></code></pre></div>
<p>We can see that there is a new row for each run, and the value that
<code>TPS</code> will be multiplied with. In this case, the TPS of the
entire profile will be modified with the same factor for each run. We
can also select, that parameters within each layer should be modified
independent from another.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tps_run_map</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/cfp_run_map.html">cfp_run_map</a></span><span class="op">(</span><span class="va">mod_pf</span>,</span>
<span>              params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"TPS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"factor"</span>,</span>
<span>              method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>              n_runs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              layers_different <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>This generates a new TPS factor for each layer in
<code>layers_map</code>. If we take a look in the <code>run_map</code>
again, we now see that there are multiple rows for each
<code>run_id</code> with a different <code>value</code> for each
layer.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tps_run_map</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A cfp_run_map to be used in alternate(). </span></span>
<span><span class="co">#&gt; number of runs:  100 </span></span>
<span><span class="co">#&gt; parameters to alternate:</span></span>
<span><span class="co">#&gt;   pmap param param_id</span></span>
<span><span class="co">#&gt; 1    1   TPS        1</span></span>
<span><span class="co">#&gt; 2    2   TPS        2</span></span>
<span><span class="co">#&gt;   pmap   site gas run_id param     value   type param_id</span></span>
<span><span class="co">#&gt; 1    1 site_a CO2      1   TPS 1.0611360 factor        1</span></span>
<span><span class="co">#&gt; 2    1 site_a CO2      2   TPS 1.0628103 factor        1</span></span>
<span><span class="co">#&gt; 3    1 site_a CO2      3   TPS 0.9807822 factor        1</span></span>
<span><span class="co">#&gt; 4    1 site_a CO2      4   TPS 0.9436862 factor        1</span></span>
<span><span class="co">#&gt; 5    1 site_a CO2      5   TPS 0.9836723 factor        1</span></span>
<span><span class="co">#&gt; 6    1 site_a CO2      6   TPS 1.0337741 factor        1</span></span></code></pre></div>
<p>We can extract the different parameters that are modified within the
<code>run_map</code> with <code><a href="../reference/extractors.html">cfp_params_df()</a></code>. This shows the
mapping between each parameter and its identifier
(<code>param_id</code>). If <code>layers_different = TRUE</code>, then
each parameter of a new layer has its own <code>param_id</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extractors.html">cfp_params_df</a></span><span class="op">(</span><span class="va">tps_run_map</span><span class="op">)</span></span>
<span><span class="co">#&gt;   pmap param param_id</span></span>
<span><span class="co">#&gt; 1    1   TPS        1</span></span>
<span><span class="co">#&gt; 2    2   TPS        2</span></span></code></pre></div>
<p>We can also define these layers from a different source, either from
<code>soilphys</code> or by providing a custom <code>data.frame</code>.
For example, in the example dataset, TPS changes in four layers within
the soilphys. Assuming these are measurements of TPS, it makes sense to
vary the TPS within these boundaries as well. To do so, we first set
<code>layers_from = "layers_altmap"</code> and provide the new
<code><a href="../reference/cfp_layers_map.html">cfp_layers_map()</a></code>, that defines the layers for the parameter
variation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ConFluxPro':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     n_groups</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">unique_tps</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/cfp_soilphys.html">cfp_soilphys</a></span><span class="op">(</span><span class="va">mod_pf</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">site</span>, <span class="va">TPS</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">upper</span><span class="op">)</span>,</span>
<span>         lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">lower</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/cfp_layers_map.html">cfp_layers_map</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>                 gas <span class="op">=</span> <span class="st">"CO2"</span>,</span>
<span>                 lowlim <span class="op">=</span> <span class="fl">0</span>, highlim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'site'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; added 'gas' to id_cols</span></span>
<span></span>
<span><span class="va">tps_run_map</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/cfp_run_map.html">cfp_run_map</a></span><span class="op">(</span><span class="va">mod_pf</span>,</span>
<span>              params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"TPS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"factor"</span>,</span>
<span>              method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>              n_runs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              layers_different <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              layers_from <span class="op">=</span> <span class="st">"layers_altmap"</span>,</span>
<span>              layers_altmap <span class="op">=</span> <span class="va">unique_tps</span><span class="op">)</span></span></code></pre></div>
<p>If we look into the result of <code><a href="../reference/extractors.html">cfp_params_df()</a></code> again, we
can see that we now have one parameter for each layer and each site. So
in total we vary eight parameters.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extractors.html">cfp_params_df</a></span><span class="op">(</span><span class="va">tps_run_map</span><span class="op">)</span></span>
<span><span class="co">#&gt;   param upper lower param_id</span></span>
<span><span class="co">#&gt; 1   TPS   -40  -100        1</span></span>
<span><span class="co">#&gt; 2   TPS   -23  -100        2</span></span>
<span><span class="co">#&gt; 3   TPS   -13   -40        3</span></span>
<span><span class="co">#&gt; 4   TPS    -7   -23        4</span></span>
<span><span class="co">#&gt; 5   TPS     0    -7        5</span></span>
<span><span class="co">#&gt; 6   TPS     0   -13        6</span></span>
<span><span class="co">#&gt; 7   TPS     5     0        7</span></span>
<span><span class="co">#&gt; 8   TPS     7     0        8</span></span></code></pre></div>
<p>By providing a <code>layers_altmap</code>, we can also specify
distinct limits for each layer individually. Let’s say the measurement
of TPS in the lower soil had a lower variation that in the topsoil. We
can generate different limits within each layer:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unique_tps_with_limits</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">unique_tps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>TPS_delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">lower</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="fl">20</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>TPS_min <span class="op">=</span> <span class="va">TPS</span> <span class="op">-</span> <span class="va">TPS_delta</span>,</span>
<span>         TPS_max <span class="op">=</span> <span class="va">TPS</span> <span class="op">+</span> <span class="va">TPS_delta</span><span class="op">)</span></span></code></pre></div>
<p>All we have to do now is tell <code>cfp_run_map</code> to use these
columns in <code>layers_altmap</code> as the new limits. We change the
numeric limits (<code>c(0.9, 1.1</code>) into a character vector
specifying the columns where these values are stored
<code>c("TPS_min", "TPS_max")</code>. Depending on our setting in
<code>layers_from</code>, the function will search for these columns in
the respective dataset. Because the new values we provided are actual
TPS values, and not factors, we also have to adjust the
<code>type</code> to <code>"abs"</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tps_run_map</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/cfp_run_map.html">cfp_run_map</a></span><span class="op">(</span><span class="va">mod_pf</span>,</span>
<span>              params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"TPS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TPS_min"</span>, <span class="st">"TPS_max"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"abs"</span>,</span>
<span>              method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>              n_runs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              layers_different <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              layers_from <span class="op">=</span> <span class="st">"layers_altmap"</span>,</span>
<span>              layers_altmap <span class="op">=</span> <span class="va">unique_tps_with_limits</span><span class="op">)</span></span></code></pre></div>
<p>Whichever <code>run_map</code> you generated, the next step is to
apply it to modify a model. This happens within the function
<code><a href="../reference/alternate.html">alternate()</a></code>, which will be discussed now.</p>
</div>
<div class="section level2">
<h2 id="alternate-run-modified-models">alternate(): Run modified models<a class="anchor" aria-label="anchor" href="#alternate-run-modified-models"></a>
</h2>
<p>To apply a <code><a href="../reference/cfp_run_map.html">cfp_run_map()</a></code> to a model, we use the function
<code><a href="../reference/alternate.html">alternate()</a></code>. We provide both the original model, and the
<code>run_map</code> we created above. The last thing we need is a
function that re-calculates the <code>soilphys</code> dataset. Because
within each run, the TPS value will be adjusted, we have to re-calculate
the AFPS and the diffusion coefficient that was calculated from it. In
our case, we can use the <code><a href="../reference/complete_soilphys.html">complete_soilphys()</a></code> function.
Depending on how your parameters are named and how they relate to
another, you may have to write your own function for that.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pf_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alternate.html">alternate</a></span><span class="op">(</span></span>
<span>  <span class="va">mod_pf</span>,</span>
<span>  f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/complete_soilphys.html">complete_soilphys</a></span><span class="op">(</span><span class="va">x</span>, DSD0_formula <span class="op">=</span> <span class="st">"a*AFPS^b"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  run_map <span class="op">=</span> <span class="va">tps_run_map</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/alternate.html">alternate()</a></code> returns an object of class
<code>cfp_altres</code>. This is simply a list of model results, with
which you can interact as usual. For example, you can access the efflux
of the third run like so:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/efflux.html">efflux</a></span><span class="op">(</span><span class="va">mod_pf_alt</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A cfp_profile object </span></span>
<span><span class="co">#&gt; id_cols: site Date gas </span></span>
<span><span class="co">#&gt; 6  unique profiles </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     site       Date gas    efflux prof_id</span></span>
<span><span class="co">#&gt; 1 site_a 2021-01-01 CO2 0.8754202       1</span></span>
<span><span class="co">#&gt; 2 site_b 2021-01-01 CO2 0.6784071       2</span></span>
<span><span class="co">#&gt; 3 site_a 2021-02-01 CO2 1.4312066       3</span></span>
<span><span class="co">#&gt; 4 site_b 2021-02-01 CO2 1.0669665       4</span></span>
<span><span class="co">#&gt; 5 site_a 2021-03-01 CO2 1.8308830       5</span></span>
<span><span class="co">#&gt; 6 site_b 2021-03-01 CO2 1.3981755       6</span></span></code></pre></div>
<p>We can also do so for all runs at the same time. This binds the
result together and adds the function <code>run_id</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">EFFLUX_alt</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/efflux.html">efflux</a></span><span class="op">(</span><span class="va">mod_pf_alt</span><span class="op">)</span> </span>
<span><span class="va">EFFLUX_alt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A cfp_profile object </span></span>
<span><span class="co">#&gt; id_cols: site Date gas run_id </span></span>
<span><span class="co">#&gt; 6  unique profiles </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     site       Date gas    efflux prof_id run_id</span></span>
<span><span class="co">#&gt; 1 site_a 2021-01-01 CO2 0.8080752       1      1</span></span>
<span><span class="co">#&gt; 2 site_b 2021-01-01 CO2 0.6703889       2      1</span></span>
<span><span class="co">#&gt; 3 site_a 2021-02-01 CO2 1.3268966       3      1</span></span>
<span><span class="co">#&gt; 4 site_b 2021-02-01 CO2 1.0514539       4      1</span></span>
<span><span class="co">#&gt; 5 site_a 2021-03-01 CO2 1.6898789       5      1</span></span>
<span><span class="co">#&gt; 6 site_b 2021-03-01 CO2 1.3814571       6      1</span></span></code></pre></div>
<p>Let’s visualize this to see how much the efflux changed only by
slightly varying the TPS of the model layers:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">EFFLUX_alt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, </span>
<span>             y <span class="op">=</span> <span class="va">efflux</span>, </span>
<span>             group <span class="op">=</span> <span class="va">run_id</span>,</span>
<span>             col <span class="op">=</span> <span class="st">"modified models"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/efflux.html">efflux</a></span><span class="op">(</span><span class="va">mod_pf</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="cn">NA</span>, col <span class="op">=</span> <span class="st">"original model"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">site</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="calibration_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="evaluate_models-find-the-effective-parameter-set">evaluate_models(): Find the effective parameter set<a class="anchor" aria-label="anchor" href="#evaluate_models-find-the-effective-parameter-set"></a>
</h2>
<p>The results stored in <code>mod_pf_alt</code> are different model
runs with different parameterizations. Some may have improved the model,
while some may have made it worse. To select the best model runs, we
have to quantify the model quality of each run. ConFluxPro comes with
two functions that estimate a specific error of the model,
<code><a href="../reference/error_funs.html">error_concentration()</a></code> and <code><a href="../reference/error_funs.html">error_efflux()</a></code>. The
first, <code><a href="../reference/error_funs.html">error_concentration()</a></code> quantifies the difference
between the measured and modeled concentration profiles and is only
applicable to <code><a href="../reference/pro_flux.html">pro_flux()</a></code> models. The second,
<code><a href="../reference/error_funs.html">error_efflux()</a></code> compares the estimated effluxes to reference
measurements (e.g. chamber method). We could combine both errors and
select the model run with the smallest overall error.</p>
<p>This whole process is streamlined within
<code><a href="../reference/evaluate_models.html">evaluate_models()</a></code>. Here, you can provide a list of error
parameters to calculate. The function applies each function to all model
runs, scales and combines the returned error parameter and returns a
list of the ‘best’ model runs. Let’s do so with the model runs
<code>mof_pf_alt</code> we calculated before. Since we don’t have actual
reference measurements, let’s pretend that the efflux estimate of the
original, unaltered model were chamber measurements we conducted. This
is just to demonstrate the process.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">EFFLUX_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/efflux.html">efflux</a></span><span class="op">(</span><span class="va">mod_pf</span><span class="op">)</span></span></code></pre></div>
<p>With this, let’s evaluate the models.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pf_eval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_models.html">evaluate_models</a></span><span class="op">(</span><span class="va">mod_pf_alt</span>,</span>
<span>                               eval_funs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                                 <span class="st">"error_concentration"</span> <span class="op">=</span> <span class="va">error_concentration</span>,</span>
<span>                                 <span class="st">"error_efflux"</span> <span class="op">=</span> <span class="va">error_efflux</span><span class="op">)</span>,</span>
<span>                               eval_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                               param_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"site"</span><span class="op">)</span>, </span>
<span>                               eval_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"site"</span><span class="op">)</span>,</span>
<span>                               n_best <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                               scaling_fun <span class="op">=</span> <span class="va">scale_min_median</span>,</span>
<span>                               EFFLUX <span class="op">=</span> <span class="va">EFFLUX_ref</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(error_parameter)`</span></span></code></pre></div>
<p>We defined two types of errors in our call within the
<code>eval_funs</code> argument. The first is the difference between the
modeled and the measured concentration profile as calculated by
<code><a href="../reference/error_funs.html">error_concentration()</a></code>. The second is the difference between
modeled and measured efflux returned by <code><a href="../reference/error_funs.html">error_efflux()</a></code>.
While we don’t have a real measurement of efflux in this case, we
provide the ‘measured’ efflux as described above as an additional
argument in <code>EFFLUX = EFFLUX_ref</code>. These functions (and any
we may write ourselves) must take the parameter <code>param_cols</code>,
indicating for which parameters a distinct error will be calculated. We
set this to be <code>"site"</code> because we want to calibrate each of
our sites individually. The function calculates an error parameter for
each combination of <code>error_funs</code> and <code>param_cols</code>.
You can define weights for each error parameter in
<code>eval_weights</code>. Finally, each parameter is scaled between the
runs. Here we set <code>scaling_fun = scale_min_median</code>, which
means that the best run for this parameter has a value of 0 and the best
50% of runs are &lt;1. For each value in <code>eval_cols</code>, all
scaled parameters are multiplied with their weighing factor and summed
up to an overall estimate of the model quality. Finally, we select the 5
best runs with the lowest model error by providing
<code>n_best = 5</code>.</p>
<p>Let’s have a look at the result. <code>evalueate_models()</code>
returns a list with different elements. The runs with the lowest model
error are stored in <code>best_runs</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pf_eval</span><span class="op">$</span><span class="va">best_runs</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   site [2]</span></span></span>
<span><span class="co">#&gt;    run_id site      ME</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     69 site_a 0.299</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     58 site_a 0.454</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     93 site_a 0.614</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     76 site_a 0.629</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     49 site_a 0.640</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     73 site_b 0.400</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     87 site_b 0.476</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     59 site_b 0.873</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     32 site_b 0.875</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     96 site_b 0.903</span></span></code></pre></div>
<p>We can see the <code>run_id</code> of the 5 best model runs for each
site and the corresponding overall model error <code>ME</code>. The
model error of all runs is stored in <code>model_error</code>…</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pf_eval</span><span class="op">$</span><span class="va">model_error</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   run_id [6]</span></span></span>
<span><span class="co">#&gt;   run_id site      ME</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     69 site_a 0.299</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     73 site_b 0.400</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     58 site_a 0.454</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     87 site_b 0.476</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     93 site_a 0.614</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     76 site_a 0.629</span></span></code></pre></div>
<p>…and the exact values of each parameter in
<code>models_evaluated</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pf_eval</span><span class="op">$</span><span class="va">models_evaluated</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   error_parameter, site [2]</span></span></span>
<span><span class="co">#&gt;   error_parameter     site   NRMSE run_id sNRMSE parameter_weight</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> error_concentration site_a 0.207      1  0.949                1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> error_concentration site_b 0.246      1  1.50                 1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> error_concentration site_a 0.197      2  0.709                1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> error_concentration site_b 0.237      2  0.970                1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> error_concentration site_a 0.221      3  1.30                 1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> error_concentration site_b 0.247      3  1.55                 1</span></span></code></pre></div>
<p>If you have a lot of profiles (e.g. a long, hourly time series), it
may be necessary to run the calibration only on a subset of profiles
because of memory limitations. In this case, you will want to run the
entire model again, once a good parameterization was found. To
facilitate this, <code><a href="../reference/evaluate_models.html">evaluate_models()</a></code> prepares a
<code><a href="../reference/cfp_run_map.html">cfp_run_map()</a></code> with only the best runs which you can use
with the complete model in <code><a href="../reference/alternate.html">alternate()</a></code>. This is stored in
<code>best_runs_runmap</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calibrated_run_map</span> <span class="op">&lt;-</span> <span class="va">mod_pf_eval</span><span class="op">$</span><span class="va">best_runs_runmap</span></span></code></pre></div>
<p>Let’s use this run map to calculate the calibrated models.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pf_cal_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alternate.html">alternate</a></span><span class="op">(</span></span>
<span>  <span class="va">mod_pf</span>,</span>
<span>  f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/complete_soilphys.html">complete_soilphys</a></span><span class="op">(</span><span class="va">x</span>, DSD0_formula <span class="op">=</span> <span class="st">"a*AFPS^b"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  run_map <span class="op">=</span> <span class="va">calibrated_run_map</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can combine the returned list into a single model frame.
This adds a new column <code>cmb_id</code> to the <code>id_cols</code>
that identifies each model run.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pf_cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_models.html">combine_models</a></span><span class="op">(</span><span class="va">mod_pf_cal_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; validating datasets</span></span>
<span><span class="co">#&gt; id_cols: site, Date, gas, cmb_id</span></span>
<span><span class="co">#&gt; 120 unique profiles</span></span>
<span><span class="va">mod_pf_cal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A cfp_pfres pro_flux model result. </span></span>
<span><span class="co">#&gt; mean RMSE achieved:  0.033075 </span></span>
<span><span class="co">#&gt; number of failed fits:  0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A cfp_pfmod pro_flux model. </span></span>
<span><span class="co">#&gt; zero_flux: TRUE  </span></span>
<span><span class="co">#&gt; zero_limits:  -Inf Inf  </span></span>
<span><span class="co">#&gt; DSD0_optim:  FALSE  </span></span>
<span><span class="co">#&gt; evenness_factor:  0  </span></span>
<span><span class="co">#&gt; known_flux_factor:  0  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A cfp_dat object to be used as input in ConFluxPro models. </span></span>
<span><span class="co">#&gt; id_cols: site Date gas cmb_id </span></span>
<span><span class="co">#&gt; number of profiles:  120 </span></span>
<span><span class="co">#&gt; number of groups:  2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Valentin Gartiser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
