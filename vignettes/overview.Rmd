---
title: "overview"
author: Valentin Gartiser
date: '2022-04-29'
output: 
  rmarkdown::html_vignette:
    number_sections: true 
    fig_width: 7
    fig_height: 4
    toc: true
    toc_depth: 3
    
vignette: >
  %\VignetteIndexEntry{overview}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
<style>
    img {
        border: 0;
    }
</style>

<img src="../inst/logo.svg" width="300" height="300" style ="float:right"/>

# Introduction

Hello and welcome to ConFluxPro - a toolkit for soil gas analysis.

This package implements the **Flux-Gradient Method (FGM)** for the calculation of
gas fluxes from concentration profiles. It provides a range of functions that cover
the complete process from raw data to modeling fluxes and beyond. A framework of S3 classes 
and methods aim to make the process as straightforward as possible while keeping 
the control of the specific model in the hands of the user.

This vignette provides an overview over the package structure, including the 
most important functions and workflows. Further vignettes will introduce the
different models, functions and processes in more detail. 

# Package structure

The following graph gives an overview over the most important functions within
ConFluxPro. There are two main data objects that are required for ConFluxPro models
**gasdata** and **soilphys**. The former contains information on *gas concentration* 
profiles, the latter corresponding information on soil physical parameters and,
most importantly, *diffusivity*. The model structure is defined in **layers_map**, 
where *layers* are defined for which different parameters are set. All data comes 
together in a single object with **cfp_dat()**. Here, the different data sources
are checked and prepared for modelling.

Models include a traditional FGM approach in **fg_flux()**, as well as an inverse
approach in **pro_flux()**. From every model result, the soil *efflux* and other 
parameters can be extracted. Further functions help improve and analyse the models.

This framework is designed to be as modular as possible, so that any kind of 
approach can be implemented. Each function has documentation attached (`?my_function`)
to help setting up the data and the models. In the next chapter a typical 
workflow will be presented using synthetic datasets that are included in the package.

```{r, echo = FALSE}
DiagrammeR::grViz(diagram = "digraph flowchart {
graph [layout = dot, rankdir = LR]


  node [style = filled color = white shape = rectangle]
  node [fillcolor = BlueViolet fontcolor = white]
  a [label = 'gasdata']
  b [label = 'soilphys']
  c [label = 'layers_map']
  h [label = 'cfp_dat']
  m [label = 'cfp_fgres']
  n [label = 'cfp_pfres']
  o [label = 'EFFLUX']
  p [label = 'PRODUCTION']
  s [label = 'cfp_altres']
  
  
  node [fillcolor = orange shape = oval fontcolor = black]
  d [label = 'cfp_dat()']
  e [label = 'cfp_gasdata()']
  f [label = 'cfp_soilphys()']
  g [label = 'cfp_layers_map()']
  i [label = 'fg_flux()']
  j [label = 'pro_flux()']
  k [label = 'efflux()']
  l [label = 'production()']
  q [label = 'run_map()']
  r [label = 'alternate()']
  
  a -> {e}
  b -> {f}
  c -> {g}
  {e f g} -> d
  d -> h
  h -> {i j}
  i -> m
  j -> n
  {m n} -> {k l r}
  k -> o
  l -> p
  q -> r
  r -> s
  
   subgraph clusterMain {
   graph [rankdir = TB]
   node [style = filled color = white shape = rectangle]
  node [fillcolor = BlueViolet fontcolor = white]
  aaa [label = 'objects']


  node [fillcolor = orange shape = oval fontcolor = black]
  bbb [label = 'functions()']
   
}
  
}
 
  ")
```

# General workflow



## data preparation

## Flux-Gradient-Method FGM

## Inverse Flux moddeling pro_flux()

