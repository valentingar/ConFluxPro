<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model layers — cfp_layers_map • ConFluxPro</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model layers — cfp_layers_map"><meta name="description" content="A function to create a cfp_layers_map object that defines the
layers of both fg_flux() and pro_flux() models."><meta property="og:description" content="A function to create a cfp_layers_map object that defines the
layers of both fg_flux() and pro_flux() models."><meta property="og:image" content="https://valentingar.github.io/ConFluxPro/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ConFluxPro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ConFluxPro.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data_preparation.html">Data preparation</a></li>
    <li><a class="dropdown-item" href="../articles/flux.html">Flux calculation</a></li>
    <li><a class="dropdown-item" href="../articles/calibration.html">Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty.html">Uncertainty estimation</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/valentingar/confluxpro/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Model layers</h1>
      <small class="dont-index">Source: <a href="https://github.com/valentingar/confluxpro/blob/main/R/cfp_layers_map.R" class="external-link"><code>R/cfp_layers_map.R</code></a></small>
      <div class="d-none name"><code>cfp_layers_map.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to create a cfp_layers_map object that defines the
layers of both <code><a href="fg_flux.html">fg_flux()</a></code> and <code><a href="pro_flux.html">pro_flux()</a></code> models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cfp_layers_map</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cfp_dat'</span></span>
<span><span class="fu">cfp_layers_map</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">cfp_layers_map</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">id_cols</span>,</span>
<span>  gas <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lowlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  highlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layer_couple <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>(data.frame) That defines the layers for which the
production or flux is modeled. Note that some parameters can also be provided
directly to the function call instead (see Details).</p><ul><li><p><code>id_cols</code> the relevant id_cols (see below)</p></li>
<li><p><code>gas</code>, the gas that is modelled.</p></li>
<li><p><code>upper</code>, <code>lower</code> the upper and lower boundaries
of each layer</p></li>
<li><p><code>lowlim</code>, <code>highlim</code> as the lower and upper limits of the
production rate to be modeled in \(\mu~mol~m^{-3}\)</p></li>
<li><p>the parameter <code>layer_couple</code>, that indicates how
strongly the layer should be linked to the one below it (0 for no coupling)</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>not used</p></dd>


<dt id="arg-id-cols">id_cols<a class="anchor" aria-label="anchor" href="#arg-id-cols"></a></dt>
<dd><p>Column names in data.frame that uniquely identify each profile.</p></dd>


<dt id="arg-gas">gas<a class="anchor" aria-label="anchor" href="#arg-gas"></a></dt>
<dd><p>(character vector) of gas names to be added to
x which is then repeated for each gas.</p></dd>


<dt id="arg-lowlim">lowlim<a class="anchor" aria-label="anchor" href="#arg-lowlim"></a></dt>
<dd><p>(numeric vector) the same length as <code>gas</code> with the
lower limit of possible production allowed in <code><a href="pro_flux.html">pro_flux()</a></code> models.</p></dd>


<dt id="arg-highlim">highlim<a class="anchor" aria-label="anchor" href="#arg-highlim"></a></dt>
<dd><p>(numeric vector)  the same length as gas with the
upper limit of possible production allowed in <code><a href="pro_flux.html">pro_flux()</a></code> models.</p></dd>


<dt id="arg-layer-couple">layer_couple<a class="anchor" aria-label="anchor" href="#arg-layer-couple"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a> (numeric_vector) A vector the same length as gas that
indicates how strongly the layer should be linked to the one below it
(0 for no coupling, the default).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="cfp_layered_profile.html">cfp_layered_profile()</a></code> <code>data.frame</code> with the columns
described above as well as <code>layer</code> and <code>pmap</code> columns that identify
each layer with an integer (ascending from bottom to top).</p>
    </div>
    <div class="section level2">
    <h2 id="add-lowlim-and-highlim-for-multiple-gases">Add lowlim and highlim for multiple gases<a class="anchor" aria-label="anchor" href="#add-lowlim-and-highlim-for-multiple-gases"></a></h2>
    <p>Sometimes it is practical to model different gases with different limits.
For example, it is a reasonable assumption that CO2 is not consumed in
relevant amounts in most soils, whereas CH4 may be both produced or consumed.
Therefore we may want to limit production rates of CO2 to only positive
values, whereas allowing for negative CH4 production rates (i.e. consumption)
as well.</p>
<p>To make this setup easy, you can provide a <code>gas</code> vector to the function
together with <code>highlim</code> and <code>lowlim</code> vectors of the same length.
The provided <code>layers_map</code> <code>data.frame</code> will then be replicated for
each gas with the respective values of the production limits provided.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other data formats:
<code><a href="cfp_dat.html">cfp_dat</a>()</code>,
<code><a href="cfp_gasdata.html">cfp_gasdata</a>()</code>,
<code><a href="cfp_layered_profile.html">cfp_layered_profile</a>()</code>,
<code><a href="cfp_profile.html">cfp_profile</a>()</code>,
<code><a href="cfp_soilphys.html">cfp_soilphys</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">cfp_layers_map</span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu">ConFluxPro</span><span class="fu">::</span><span class="va"><a href="layers_map.html">layers_map</a></span>,</span></span>
<span class="r-in"><span>   gas <span class="op">=</span> <span class="st">"CO2"</span>,</span></span>
<span class="r-in"><span>   lowlim <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>   highlim <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>   id_cols <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> added 'gas' to id_cols</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A cfp_layers_map object </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id_cols: site gas </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  unique profiles </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     site upper lower gas lowlim highlim layer_couple layer pmap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 site_a     0  -100 CO2      0    1000            0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 site_b     0  -100 CO2      0    1000            0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 site_a     5     0 CO2      0    1000            0     2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 site_b     7     0 CO2      0    1000            0     2    2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### add multiple gases at once</span></span></span>
<span class="r-in"><span><span class="fu">cfp_layers_map</span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu">ConFluxPro</span><span class="fu">::</span><span class="va"><a href="layers_map.html">layers_map</a></span>,</span></span>
<span class="r-in"><span>   id_cols <span class="op">=</span> <span class="st">"site"</span>,</span></span>
<span class="r-in"><span>   gas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO2"</span>, <span class="st">"CH4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   lowlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   highlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> added 'gas' to id_cols</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A cfp_layers_map object </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id_cols: site gas </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  unique profiles </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     site upper lower gas lowlim highlim layer_couple layer pmap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 site_a     0  -100 CO2      0    1000            0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 site_b     0  -100 CO2      0    1000            0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 site_a     0  -100 CH4  -1000    1000            0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 site_b     0  -100 CH4  -1000    1000            0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 site_a     5     0 CO2      0    1000            0     2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 site_a     5     0 CH4  -1000    1000            0     2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 site_b     7     0 CO2      0    1000            0     2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 site_b     7     0 CH4  -1000    1000            0     2    2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Extract from an existing cfp_dat</span></span></span>
<span class="r-in"><span><span class="fu">cfp_layers_map</span><span class="op">(</span><span class="fu">ConFluxPro</span><span class="fu">::</span><span class="va"><a href="base_dat.html">base_dat</a></span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A cfp_layers_map object </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id_cols: site gas </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  unique profiles </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     site upper lower gas lowlim highlim layer_couple layer pmap</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 site_a     0  -100 CO2      0    1000            0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 site_b     0  -100 CO2      0    1000            0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 site_a     5     0 CO2      0    1000            0     2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 site_b     7     0 CO2      0    1000            0     2    2</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Valentin Gartiser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

